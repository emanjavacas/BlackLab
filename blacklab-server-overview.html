<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2016-08-23 
 | Rendered using Apache Maven Fluido Skin 1.4
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160823" />
    <meta http-equiv="Content-Language" content="en" />
    <title>BlackLab &#x2013; Introduction</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.4.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.4.min.js"></script>

                          
        
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Nunito:300"/>
          
                  </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                                                                                                <img src="images/logo-blacklab.png"  alt="BlackLab"/>
                </div>
                      </div>
        <div class="pull-right">                  <a href="http://www.inl.nl/" id="bannerRight">
                                                                                                <img src="images/logo-inl.png"  alt="INL"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="http://www.inl.nl/" class="externalLink" title="INL">
        INL</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="index.html" title="BlackLab">
        BlackLab</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Introduction</li>
        
                
                    
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2016-08-23</li>
              <li id="projectVersion" class="pull-right">
                    Version: 1.6.0-SNAPSHOT
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">BlackLab</li>
                              
      <li>
  
                          <a href="index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                                                                                                                                                                                                                      
      <li>
  
                          <a href="learn.html" title="Learn">
          <span class="icon-chevron-down"></span>
        Learn</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="getting-started.html" title="Getting Started">
          <span class="none"></span>
        Getting Started</a>
            </li>
                    
      <li>
  
                          <a href="corpus-query-language.html" title="Corpus Query Language">
          <span class="none"></span>
        Corpus Query Language</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>BlackLab Server overview</a>
          </li>
                    
      <li>
  
                          <a href="blacklab-server-different-languages.html" title="Using BlackLab Server from different languages">
          <span class="none"></span>
        Using BlackLab Server from different languages</a>
            </li>
                    
      <li>
  
                          <a href="indexing-with-blacklab.html" title="Indexing with BlackLab">
          <span class="none"></span>
        Indexing with BlackLab</a>
            </li>
                    
      <li>
  
                          <a href="add-input-format.html" title="Add An Input Format">
          <span class="none"></span>
        Add An Input Format</a>
            </li>
                    
      <li>
  
                          <a href="improve-search-speed.html" title="Improve Search Speed">
          <span class="none"></span>
        Improve Search Speed</a>
            </li>
                    
      <li>
  
                          <a href="apidocs/index.html" title="API reference">
          <span class="none"></span>
        API reference</a>
            </li>
                    
      <li>
  
                          <a href="file-formats.html" title="File formats">
          <span class="none"></span>
        File formats</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="downloads.html" title="Downloads">
          <span class="none"></span>
        Downloads</a>
            </li>
                
      <li>
  
                          <a href="faq.html" title="FAQ">
          <span class="none"></span>
        FAQ</a>
            </li>
                
      <li>
  
                          <a href="changelog.html" title="Change Log">
          <span class="none"></span>
        Change Log</a>
            </li>
                
      <li>
  
                          <a href="roadmap.html" title="Road Map">
          <span class="none"></span>
        Road Map</a>
            </li>
                
      <li>
  
                          <a href="newsletter.html" title="Newsletter">
          <span class="none"></span>
        Newsletter</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                                      
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Introduction</h1>
<div class="section">
<h2><a name="What_is_BlackLab_Server"></a>What is BlackLab Server?</h2>
<p>BlackLab Server is a REST web service for accessing <a href="../">BlackLab</a> indices. This makes it easy to use BlackLab from your favourite programming language. It can be used for anything from quick analysis scripts to full-featured corpus search applications.</p>
<p>This page explains how to set up and use BlackLab Server. See the <a href="../">BlackLab homepage</a> for more information on the underlying corpus search engine.</p>

<ul>
  
<li><a href="#features">Features</a></li>
  
<li><a href="#overview">Overview</a></li>
  
<li><a href="#requests">Requests</a></li>
  
<li><a href="#sorting-grouping-faceting">Sorting, grouping &amp; faceting</a></li>
  
<li><a href="#examples">Examples</a></li>
  
<li><a href="#installation">Installation</a></li>
  
<li><a href="#configuration-file">Configuration file</a></li>
  
<li><a href="#error-and-status-responses">Error and status responses</a></li>
</ul>
<p><a name="features" id="features"></a></p></div>
<div class="section">
<h2><a name="Features"></a>Features</h2>

<ul>
  
<li>Supports XML, JSON and JSONP, making it very easy to use from any programming language.</li>
  
<li>Supports faceted search, giving users an overview of their search results and allowing them to easily refine them.</li>
  
<li>Uses a stateless protocol and persistent identifiers, making it possible to develop web applications that &#x201c;feel at home&#x201d; in the browser, meaning they can be bookmarked, opened in multiple tabs and properly support the back button.</li>
  
<li>Makes very responsive (AJAX or &#x2018;regular&#x2019;) web applications possible because requests return all relevant information at once and both client and server can make use of caching.</li>
  
<li>One BlackLab Server instance can be used for multiple corpora; this means you need less configuration and fewer server resources.</li>
  
<li>BlackLab Server can be tuned in terms of server load and client responsiveness. Possible settings are, for example: strive for X free memory on the server; allow any client at most X running jobs; let clients cache resultats for X amount of time.</li>
  
<li>Provides debug information (e.g. show all searches in the cache)</li>
  
<li>Has many configurable defaults: page size, context size, default response format, default query language, etc. Of course defaults may be overridden for each request.</li>
</ul>
<p><a name="overview" id="overview"></a></p></div>
<div class="section">
<h2><a name="Overview"></a>Overview</h2>
<p>BlackLab Server is a read-only REST webservice. Only GET requests are supported.</p>
<p>It is stateless: a particular URL will always result in the same response. There&#x2019;s one exception to this: when the server has the requested set of results, it might indicate that it is still counting the total number of results, and has counted X so far. The client may keep doing additional requests to update the running count for the user. This way, the user gets to see the first results as soon as possible, and she&#x2019;ll be able to see that the total number of results is still being counted.</p>
<p>The webservice answers in JSON or XML. Selection of the desired output format is done through the HTTP Accept header (value &#x201c;application/json&#x201d; or &#x201c;application/xml&#x201d;), or by passing an extra parameter &#x201c;outputformat&#x201d; (value &#x201c;json&#x201d; or &#x201c;xml&#x201d;). If both are specified, the parameter has precedence. If neither are specified, the configured default format is used (usually XML).</p>
<p>An extra option is JSONP (&#x201c;padded JSON&#x201d;, for when the webservice is running on a different host than the web application). Use the &#x201c;jsonp&#x201d; parameter for this (see next section).</p>
<p><a name="requests" id="requests"></a></p></div>
<div class="section">
<h2><a name="Requests"></a>Requests</h2>
<p>A request to BlackLab Server has the following structure:</p>
<p><a class="externalLink" href="http://server/webservice/corpus/resource?parameters">http://server/webservice/corpus/resource?parameters</a></p>
<p>Here&#x2019;s what the various parts of this URL mean:</p>

<table border="0" class="table table-striped">
	
<tr class="a">
		
<th style="text-align:left;">Part        </th>
		
<th style="text-align:left;">Meaning</th>
	</tr>
	
<tr class="b">
		
<td>server      </td>
		
<td>the server name, e.g. &#x201c;blacklab.inl.nl&#x201d;</td>
	</tr>
	
<tr class="a">
		
<td>webservice  </td>
		
<td>the web service name, e.g. &#x201c;blacklab-server&#x201d;</td>
	</tr>
	
<tr class="b">
		
<td>corpus      </td>
		
<td>the corpus (i.e. text collection) to search, e.g. &#x201c;opensonar&#x201d;</td>
	</tr>
	
<tr class="a">
		
<td>resource    </td>
		
<td>what type of information we&#x2019;re looking for (hits, docs, docs/pid, docs/pid/content, &#x2026;) (see below for the meaning of each resource)</td>
	</tr>
	
<tr class="b">
		
<td>pid         </td>
		
<td>persistent identifier for the document. This refers to a metadata field that must be configured per corpus (in the index metadata JSON file; see documentation about indexing with BlackLab). Any field that uniquely identifies the document and won&#x2019;t change in the future will do. You can retrieve documents with this pid, and result sets will use it to refer to the corresponding documents.&gt;<br /><br /><b>NOTE:</b> BlackLab Server will use the Lucene document id instead of a true persistent identifier if your corpus has no persistent identifier configured, but this is not recommended: Lucene document ids can change if you re-index or compact the index, so bookmarked URLs may not always return to the same information.</td>
	</tr>
	
<tr class="a">
		
<td>parameters  </td>
		
<td>search and result parameters, that indicate what pattern you wish to look for, what metadata values you wish to filter on, what to group or sort on, what part of the results to show, what data format to return results in, etc. (see below)</td>
	</tr>
</table>
<p>Explanation of the various resources:</p>

<table border="0" class="table table-striped">
	
<tr class="a">
		
<th style="text-align:left;">Resource        </th>
		
<th style="text-align:left;">Meaning</th>
	</tr>
	
<tr class="b">
		
<td>hits </td>
		
<td>A set of occurrences of a pattern in the corpus (optionally filtered on document properties as well). This resource can also return the result of grouping hits (returning a list of groups), or the contents of one such group (if you wish to the hits in a group).</td>
	</tr>
	
<tr class="a">
		
<td>docs </td>
		
<td>A set of documents that contain a certain pattern and/or match a certain document filter query. This resource can also return the result of grouping document results, or show the contents of one such group.</td>
	</tr>
	
<tr class="b">
		
<td>docs/pid </td>
		
<td>Metadata for a document</td>
	</tr>
	
<tr class="a">
		
<td>docs/pid/contents </td>
		
<td>Contents of a document. This returns the original input XML.</td>
	</tr>
	
<tr class="b">
		
<td>docs/pid/snippet </td>
		
<td>Uses the forward index to retrieve a snippet of the document.</td>
	</tr>
</table>
<p>Below is an overview of parameters that can be passed to the various resources. Default values for most parameters can be configured on the server; below are a few suggestions for defaults.</p>
<p>(NOTE: parameters in italics haven&#x2019;t been implemented yet)</p>

<table border="0" class="table table-striped">
	
<tr class="a">
		
<th style="text-align:left;">Parameter        </th>
		
<th style="text-align:left;">Meaning</th>
	</tr>
	
<tr class="b">
		
<td>patt </td>
		
<td>Pattern to search for.</td>
	</tr>
	
<tr class="a">
		
<td>pattlang </td>
		
<td>Query language for the patt parameter. (default: corpusql, Corpus Query Language. Also supported: contextql, Contextual Query Language (only very basic support though)) and lucene (Lucene Query Language).</td>
	</tr>
	
<tr class="b">
		
<td>pattfield </td>
		
<td>Content field to search. (default: the main contents field, corpus-specific. Usually &#x201c;contents&#x201d;.)</td>
	</tr>
	
<tr class="a">
		
<td>filter </td>
		
<td>Document filter query, e.g. &#x201c;publicationYear:1976&#x201d; (default: none)</td>
	</tr>
	
<tr class="b">
		
<td>filterlang </td>
		
<td>Query language for filter parameter. Supported are lucene (Lucene Query Language) and (limited) contextql (contextual query language).(default: lucene )</td>
	</tr>
	
<tr class="a">
		
<td>docpid </td>
		
<td>Filter on a single document pid, e.g. &#x201c;DOC0001&#x201d; (default: none)</td>
	</tr>
	
<tr class="b">
		
<td>wordsaroundhit </td>
		
<td>Number of words of context to retrieve for hits- and docs-results (default: 5)</td>
	</tr>
	
<tr class="a">
		
<td>sort </td>
		
<td>Sorting criteria, comma-separated. &#x2018;-&#x2019; reverses sort order. See below. (default: don&#x2019;t sort)</td>
	</tr>
	
<tr class="b">
		
<td>group </td>
		
<td>Grouping criteria, comma-separated. See below. (default: don&#x2019;t group)</td>
	</tr>
	
<tr class="a">
		
<td>viewgroup </td>
		
<td>Identity of one of the groups to view (identity values are returned with the grouping results).</td>
	</tr>
	
<tr class="b">
		
<td>facets </td>
		
<td>Document faceting criteria, comma-separated. See below.  (default: don&#x2019;t do any faceting)</td>
	</tr>
	
<tr class="a">
		
<td><i>collator</i></td>
		
<td>What collator to use for sorting and grouping (default: nl)</td>
	</tr>
	
<tr class="b">
		
<td>first </td>
		
<td>First result (0-based) to return (default: 0)</td>
	</tr>
	
<tr class="a">
		
<td>number </td>
		
<td>Number of results to return (if available) (default: 50)</td>
	</tr>
	
<tr class="b">
		
<td>hitstart </td>
		
<td>(snippet operation) First word (0-based) of the hit we want a snippet around (default: 0)</td>
	</tr>
	
<tr class="a">
		
<td>hitend </td>
		
<td>(snippet operation) First word (0-based) after the hit we want a snippet around (default: 1)</td>
	</tr>
	
<tr class="b">
		
<td>wordstart </td>
		
<td>(snippet/contents operations) First word (0-based) of the snippet/part of the document we want. -1 for document start. NOTE: partial contents XML output will be wrapped in &lt;blacklabResponse/&gt; element to ensure a single root element.</td>
	</tr>
	
<tr class="a">
		
<td>wordend </td>
		
<td>(snippet/contents operations) First word (0-based) after the snippet/part of the document we want. -1 for document end.</td>
	</tr>
	
<tr class="b">
		
<td>block (deprecated)</td>
		
<td>Blocking (&#x201c;yes&#x201d;) or nonblocking (&#x201c;no&#x201d;) request? (default: yes) 
		    <br /><b>NOTE:</b> nonblocking requests will be removed in a future version.</td>
	</tr>
	
<tr class="a">
		
<td>waitfortotal </td>
		
<td>Whether or not to wait for the total number of results to be known. If no (the default), subsequent requests (with number=0 if you don&#x2019;t need more hits) can be used to monitor the total count progress. (default: no)</td>
	</tr>
	
<tr class="b">
		
<td>maxretrieve </td>
		
<td>Maximum number of hits to retrieve. -1 means &quot;no limit&quot;. Also affects documents-containing-pattern queries and grouped-hits queries. Default configurable in blacklab-server.json. Very large values (millions, or unlimited) may cause server problems.</td>
	</tr>
	
<tr class="a">
		
<td>maxcount </td>
		
<td>Maximum number of hits to count. -1 means &quot;no limit&quot;. Default configurable in blacklab-server.json. Even when BlackLab stops retrieving hits, it still keeps counting. For large results sets this may take a long time.</td>
	</tr>
	
<tr class="b">
		
<td>outputformat </td>
		
<td>&#x201c;json&#x201d; or &#x201c;xml&#x201d;. (Default: check the HTTP Accept header, or use the server default (usually xml) if none was specified. NOTE: most browsers send a default Accept header including XML.</td>
	</tr>
	
<tr class="a">
		
<td>jsonp </td>
		
<td>Name of JSONP callback function to use. Automatically forces the outputformat to JSONP. (A JSONP response is a Javascript with a single function call that gets the JSON response object as its parameter. This is used to circumvent browsers' Same Origin Policy that blocks AJAX calls to other domains)</td>
	</tr>
	
<tr class="b">
		
<td>prettyprint </td>
		
<td>yes or no. Determines whether or not the output is on separate lines and indented. Useful while debugging. (default: no (yes in debug mode, see configuration))</td>
	</tr>
	
<tr class="a">
		
<td>includetokencount </td>
		
<td>yes or no. Determines whether or not a document search includes the total number of tokens in the matching documents. Slower, because all document information has to to be fetched to calculate this. (default: no)</td>
	</tr>
	
<tr class="b">
		
<td>usecontent </td>
		
<td>fi or orig. fi uses the forward index to reconstruct document content (for snippets and concordances; inline tags are lost in the process), orig uses the original XML from the content store (slower but more accurate).</td>
	</tr>
	
<tr class="a">
		
<td>calc </td>
		
<td>(empty) or colloc. Calculate some information from the result set. Currently only supports calculating collocations (frequency lists of words near hits).</td>
	</tr>
	
<tr class="b">
		
<td>sample</td>
		
<td>Percentage of hits to select. Chooses a random sample of all the hits found.</td>
	</tr>
	
<tr class="a">
		
<td>samplenum</td>
		
<td>Exact number of hits to select. Chooses a random sample of all the hits found.</td>
	</tr>
	
<tr class="b">
		
<td>sampleseed</td>
		
<td>Signed long random seed for sampling. Optional. When given, uses this value to seed the random number
		    generator, ensuring identical sampling results next time. Please note that, without sorting, hit order
		    is undefined (if the same data is re-indexed, hits may be produced in a different order). So if you 
		    want true reproducability, you should always sort hits that you want to sample.</td>
	</tr>
</table>
<p>NOTE: using the original content may cause problems with well-formedness; these are fixed automatically, but the fix may result in inline tags in strange places (e.g. a start-sentence tag that is not at the start of the sentence anymore)</p>
<p><a name="sorting-grouping-faceting" id="sorting-grouping-faceting"></a></p></div>
<div class="section">
<h2><a name="Sorting_grouping__faceting"></a>Sorting, grouping &amp; faceting</h2>
<p>The sort, group and facets parameters receive one or more criteria (comma-separated) that indicate what to sort, group or facet on.</p>

<table border="0" class="table table-striped">
	
<tr class="a">
		
<th style="text-align:left;">Criterium        </th>
		
<th style="text-align:left;">Meaning</th>
	</tr>
	
<tr class="b">
		
<td>hit[:prop[:c]] </td>
		
<td>Sort/group/facet on matched text. If prop is omitted, the default property (usually word) is used. c can specify case-sensitivity: either s (sensitive) or i (insensitive). prop and c can also be added to left, right, wordleft and wordright. Examples: hit, hit:lemma, hit:lemma:s.</td>
	</tr>
	
<tr class="a">
		
<td>left / right </td>
		
<td>Left/right context words. Used for sorting, not for grouping/faceting (use wordleft/wordright instead). Examples: left, left:pos, left:pos:s.</td>
	</tr>
	
<tr class="b">
		
<td>context</td>
		
<td>More generic context words expression, giving the user more control at the cost of a bit of speed. Examples:
		    context:word:s:H1-1;E1-1 (first (H1-1) and last (E1-1) matched word), context:word:s:H2 (all but the first matched word), context:word:s:R2-3 (second and third 
		    word to the right of the match), context:word:s:L1 (left context, starting from first word to the left of the hit, i.e. the same as left:word:s)</td>
	</tr>
	
<tr class="a">
		
<td>wordleft / wordright </td>
		
<td>Single word to the left or right of the matched text. Used for grouping/faceting. Examples: wordleft, wordleft:pos</td>
	</tr>
	
<tr class="b">
		
<td>field:name </td>
		
<td>Metadata field</td>
	</tr>
	
<tr class="a">
		
<td>decade:name </td>
		
<td>Sort/group by the decade of the year given in specified metadata field.</td>
	</tr>
	
<tr class="b">
		
<td>numhits </td>
		
<td>(for sorting per-document results) Sort by number of hits in the document.</td>
	</tr>
	
<tr class="a">
		
<td>identity </td>
		
<td>(for sorting grouping results) Sort by group identity.</td>
	</tr>
	
<tr class="b">
		
<td>size </td>
		
<td>(for sorting grouping results) Sort by group size, descending by default.</td>
	</tr>
</table>
<p><a name="examples" id="examples"></a></p></div>
<div class="section">
<h2><a name="Examples"></a>Examples</h2>
<div class="section">
<h3><a name="Scripts"></a>Scripts</h3>
<p>For examples of using BlackLab Server from (many) different programming languages, see <a href="from-different-languages.html">here</a>.</p></div>
<div class="section">
<h3><a name="Requests"></a>Requests</h3>
<p>(NOTE: for clarity, double quotes have not been URL-encoded)</p>
<p>Information about the webservice; list of available indices</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/ (trailing slash optional)
</pre></div></div>
<p>Information about the &#x201c;opensonar&#x201d; corpus (structure, fields, human-readable names)</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/opensonar/ (trailing slash optional)
</pre></div></div>
<p>All occurrences of &#x201c;test&#x201d; in the &#x201c;opensonar&#x201d; corpus (CorpusQL query)</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/opensonar/hits?patt=&quot;test&quot;
</pre></div></div>
<p>All documents having &#x201c;guide&#x201d; in the title and &#x201c;test&#x201d; in the contents, sorted by author and date, resultats 61-90</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/opensonar/docs?filter=title:guide&amp;patt=&quot;test&quot;&amp; sort=field:author,field:date&amp;first=61&amp;number=30
</pre></div></div>
<p>Occurrences of &#x201c;test&#x201d;, grouped by the word left of each hit</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/opensonar/hits?patt=&quot;test&quot;&amp;group=wordleft
</pre></div></div>
<p>Documents containing &#x201c;test&#x201d;, grouped by author</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/opensonar/docs?patt=&quot;test&quot;&amp;group=field:author
</pre></div></div>
<p>Metadata of document with specific PID</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/opensonar/docs/0345391802
</pre></div></div>
<p>The entire original document</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/opensonar/docs/0345391802/contents
</pre></div></div>
<p>The entire document, with occurrences of &#x201c;test&#x201d; highlighted (with &lt;hl/&gt; tags)</p>

<div class="source">
<div class="source"><pre class="prettyprint">    http://blacklab.inl.nl/blacklab-server/opensonar/docs/0345391802/contents?patt=&quot;test&quot;
</pre></div></div></div>
<div class="section">
<h3><a name="Output"></a>Output</h3>
<p>(Description of output format coming soon. Please try in the browser for now; use outputformat=json or outputformat=xml)</p>
<p><a name="installation" id="installation"></a></p></div></div>
<div class="section">
<h2><a name="Installation"></a>Installation</h2>
<p>First, you need the BlackLab Server WAR file. You can either download the latest release [https://github.com/INL/BlackLab/releases here], or you can build it by cloning the [https://github.com/INL/BlackLab GitHub repository] and building it using Maven.</p>
<p>BlackLab Server needs to run in a Java application server that support servlets. We&#x2019;ll assume Apache Tomcat here, but others should work almost the same.</p>
<p>For larger indices, it is important to give Tomcat&#x2019;s JVM enough heap memory. See [http://crunchify.com/how-to-change-jvm-heap-setting-xms-xmx-of-tomcat/ here]. (If heap memory is low and/or fragmented, the JVM garbage collector might start taking 100% CPU moving objects in order to recover enough free space, slowing things down to a crawl.)</p>
<p>Place the configuration file blacklab-server.json (see Appendix A) in /etc/blacklab/ or, if you prefer, on the application server&#x2019;s classpath. Make sure at least the &#x201c;indexCollections&#x201d; setting is correctly specified (should point to a directory containing one or more BlackLab indices as subdirectories). Apart from that, the file could actually be empty: default values are used for missing settings. So if you have an index in directory /home/jan/blacklab/test, the minimal blacklab-server.json looks like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{ &quot;indexCollections&quot;: [ &quot;/home/jan/blacklab&quot; ] }
</pre></div></div>
<p>Place blacklab-server.war in Tomcat&#x2019;s webapps directory ($TOMCAT/webapps/). Tomcat should automatically discover and deploy it, and you should be able to go to <a class="externalLink" href="http://servername:8080/blacklab-server/" title="http://servername:8080/blacklab-server/">http://servername:8080/blacklab-server/</a> and see the BlackLab Server information page, which includes a list of available corpora.</p>
<p>To (significantly!) improve performance of certain operations, including sorting and grouping large result sets, you might want to consider using the <a class="externalLink" href="https://github.com/INL/BlackLab/wiki/Improve-search-speed-using-the-disk-cache" title="https://github.com/INL/BlackLab/wiki/Improve-search-speed-using-the-disk-cache">vmtouch</a> tool to lock files in the OS&#x2019;s disk cache.</p>
<p><a name="configuration-file" id="configuration-file"></a></p></div>
<div class="section">
<h2><a name="Configuration_file"></a>Configuration file</h2>
<p>Below is a complete example of the configuration file (blacklab-server.json) including comments (contrary to the JSON standard, this file may contain double slash end-of-line comments).</p>
<p>You should at least have an &#x201c;indexCollections&#x201d; or &#x201c;indices&#x201d; setting, so you have at least one index to search. All other parameters are optional and may, for example, be used to improve performance.</p>
<p>The blacklab-server.json file should be placed in /etc/blacklab/.</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    // BlackLab Server config file
    // ===============================================================
    // NOTE: this file is in JSON format, with end-of-line comments (//)
    // allowed.

    // The available indices
    // ---------------------------------------------------------------

    // Index collections are multiple indices as subdirectories of a 
    // single directory. BLS will detect when an index is added and 
    // make it available to query. It will also detect if it has been 
    // removed.
    // NOTE: if multiple collections contain indices with the
    // same name, one of them is picked at random; therefore it&amp;#39;s best
    // to avoid this.
    &quot;indexCollections&quot;: [
        &quot;/data/blacklab-indices/&quot;
    ],

    // A list of single indices and where they can be found. 
    &quot;indices&quot;: {
        &quot;brown&quot;: {
            &quot;dir&quot;: &quot;/data/brown-corpus/index&quot;
        }
    },

    // Configuration that affects how requests are handled
    // ---------------------------------------------------------------
    &quot;requests&quot;: {
        // Default number of hits/results per page.
        // The &quot;number&quot; GET parameter overrides this value.
        &quot;defaultPageSize&quot;: 20,

        // Maximum number of hits/results per page allowed.
        // (if the &quot;number&quot; GET variable is set to a higher value,
        //  the above default page size will be used instead)
        &quot;maxPageSize&quot;: 3000,

        // Default number of words around hit.
        // The &quot;wordsaroundhit&quot; GET parameter overrides this value.
        &quot;defaultContextSize&quot;: 5,

        // Maximum context size allowed. Only applies to sets of hits,
        // not to individual snippets.
        &quot;maxContextSize&quot;: 20,

        // Maximum snippet size allowed. If this is too big, users can
        // view the whole document even if they may not be allowed to.
        // (this applies to the &quot;wordsaroundhit&quot; GET parameter of the 
        // /docs/ID/snippet resource)
        &quot;maxSnippetSize&quot;: 100,

        // Default maximum number of hits to retrieve. This affects 
        // not only regular hits searches, but also 
        // documents-containing-pattern searches (will stop yielding 
        // documents when the max. hit number is reached) and 
        // grouped-hits searches (will only group this number of hits
        // at most).
        // The search summary will show you whether the retrieval 
        // limit was reached or not. -1 means &quot;no limit&quot;. For large 
        // corpora, this can crash the server if uses perform big 
        // searches.
        &quot;defaultMaxHitsToRetrieve&quot;: 1000000,

        // Default maximum number of hits to count.
        // BlackLab will keep counting hits even if it hits the 
        // retrieval maximum. The default value for this is -1,
        // meaning &quot;no limit&quot;. Counts for large hit sets will take a 
        // long time but will generally not crash the server.
        &quot;defaultMaxHitsToCount&quot;: 10000000,

        // Users can change the above retrieval maximum with the
        // &quot;maxretrieve&quot; URL parameter. This specifies the maximum 
        // allowed value for that parameter. -1 means &quot;no limit&quot;.
        &quot;maxHitsToRetrieveAllowed&quot;: 1000000,

        // Users can change the above count maximum with the 
        // &quot;maxcount&quot; URL parameter. This specifies the maximum 
        // allowed value for that parameter. -1 means &quot;no limit&quot;.
        &quot;maxHitsToCountAllowed&quot;: 10000000,

        // Clients from these IPs may choose their own user id and 
        // send  it along in a GET parameter &quot;userid&quot;. This setting 
        // exists for web applications that contact the webservice
        // (partly) through the server component. They would get the 
        // same session id for each user, making them likely to hit 
        // the maxRunningJobsPerUser setting. Instead, they should 
        // assign session IDs for each of their clients and send them
        // along with any request to the webservice.
        &quot;overrideUserIdIps&quot;: [
            &quot;127.0.0.1&quot;,      // IPv4 localhost
            &quot;0:0:0:0:0:0:0:1&quot; // IPv6 localhost
        ],
    },

    // Settings related to tuning server load and client 
    // responsiveness
    // ---------------------------------------------------------------
    &quot;performance&quot;: {

        // Settings to make sure running operations (fetching results, 
        // sorting, grouping) behave. Note that a search job may consist
        // of several of these operations. NOTE: EXPERIMENTAL!
        &quot;operations&quot;: {

            // An operation that takes really
            // long should be interrupted. After how many seconds we should interrupt
            // an operation? (default: 240 == 4 mins)
            // (Note that a search job may consist of several operations, but long search
            // jobs should be detected and aborted eventually as well - this is just an 
            // extra safeguard for stopping out of control searches earlier)
            &quot;interruptAfterSec&quot;: 240

            // Threads that run for a while should sleep occasionally to give
            // other threads a chance as well. If they didn&amp;#39;t, they could end up
            // hogging the CPU. We don&amp;#39;t start this sleeping behaviour immediately,
            // because threads that finish quickly don&amp;#39;t pose much of a problem.
            // After how many seconds should we sleep occasionally? (default: 5)
            &quot;startSleepingAfterSec&quot;: 5,

            // The longer a search job is running, the longer we sleep. This
            // determines how fast the part of the cycle the sleep takes will
            // increase per second. The higher you set this, the worse long
            // jobs will run, but the nicer they will play with other jobs.
            // (default: 0.004 == 0.4% increase/s)
            &quot;sleepPartIncreaseSpeed&quot;: 0.004,

            // This determines the maximum part of the cycle we&amp;#39;ll devote to
            // sleep. The higher you set this, the worse (REALLY) long jobs 
            // will run, but the nicer they will play with other jobs
            // (default: 0.5 == 50%)
            &quot;maxSleepPart&quot;: 0.5,

            // When sleeping occasionally, we think in &quot;cycles&quot;: a period of activity
            // followed by a period of sleeping. Longer cycles are more efficient
            // because of less thread switching.
            // How many ms should 1 wake/sleep cycle take? (default: 1000)
            &quot;wakeSleepCycleMs&quot;: 1000,

        },

        // Settings for job caching.
        &quot;cache&quot;: {
            // How many search jobs will we cache at most? (or -1 for 
            // no limit) A note about jobs: a request to BlackLab 
            // Server routinely results in 3+ simultaneous search jobs
            // being launched: a job to get a window into the sorted 
            // hits, which launches a job to get sorted hits, which 
            // launches a job to get the unsorted hits. There&amp;#39;s also 
            // usually a separate job for keeping track of the running
            // total number of hits found (which re-uses the unsorted
            // hits job). The reason for this architecture is that 
            // jobs can be more easily re-used in subsequent searches
            // that way: if the sort changes, we can still use the 
            // unsorted hits job, etc. Practical upshot of this: 
            // number of jobs does not equal number of searches. Don&#x2019;t
            // set this too low.
            &quot;maxNumberOfJobs&quot;: 100,

            // After how much time will a search job be removed from 
            // the cache? (in seconds)
            &quot;maxJobAgeSec&quot;: 3600,

            // Maximum size the cache may grow to (in megabytes), or 
            // -1 for no limit.
            // [NOT PROPERLY IMPLEMENTED YET! LEAVE AT -1 FOR NOW]
            &quot;maxSizeMegs&quot;: -1,

            // How much free memory the cache should shoot for (in 
            // megabytes) while cleaning up. Because we don&amp;#39;t have 
            // direct control over the garbage collector, we can&amp;#39;t 
            // reliably clean up until this exact number is available.
            // Instead we just get rid of a few cached jobs whenever a
            // new job is added and we&amp;#39;re under this target number.
            // See numberOfJobsToPurgeWhenBelowTargetMem.
            &quot;targetFreeMemMegs&quot;: 100,

            // When there&amp;#39;s less free memory available than 
            // targetFreeMemMegs, each time a job is created and added
            // to the cache, we will get rid of this number of older 
            // jobs in order to (hopefully) free up memory (if the 
            // Java GC agrees with us). 2 seems like an okay value, 
            // but you can change it if you want to experiment.
            &quot;numberOfJobsToPurgeWhenBelowTargetMem&quot;: 2
        },

        // The minimum amount of free memory required to start a new 
        // search job. If this memory is not available, an error 
        // message is returned.
        &quot;minFreeMemForSearchMegs&quot;: 50,

        // The maximum number of jobs a user is allowed to have 
        // running at the same time. This does not include finished 
        // jobs in the cache, only jobs that have not finished yet.
        // The above remark about jobs applies here too: one search 
        // request will start multiple jobs. Therefore, this value 
        // shouldn&amp;#39;t be set too low. This setting is meant to prevent
        // over-eager scripts and other abuse from bringing down the
        // server. Regular users should never hit this limit.
        &quot;maxRunningJobsPerUser&quot;: 20,

        // How long the client may keep results we give them in their
        // local (browser) cache. This is used to write HTTP cache 
        // headers. Low values mean clients might re-request the same 
        // information, making clients less responsive and consuming 
        // more network resources. Higher values make clients more 
        // responsive but could cause problems if the data (or worse,
        // the protocol) changes after an update. A value of an hour 
        // or so seems reasonable.
        &quot;clientCacheTimeSec&quot;: 3600

    },

    // A list of IPs that will run in debug mode.
    // In debug mode, ...
    // - the /cache-info resource show the contents of the job cache
    //   (other debug information resources may be added in the 
    //   future)
    // - output is prettyprinted by default (can be overriden with the
    //   &quot;prettyprint&quot;
    //   GET parameter)
    &quot;debugModeIps&quot;: [
        &quot;127.0.0.1&quot;,      // IPv4 localhost
        &quot;0:0:0:0:0:0:0:1&quot; // IPv6 localhost
    ]

}
</pre></div></div>
<p><a name="error-and-status-responses" id="error-and-status-responses"></a></p></div>
<div class="section">
<h2><a name="Error_and_status_responses"></a>Error and status responses</h2>
<p>BLS can return these error and status codes. The associated human-readable message is informational only and can be shown to the user if you want; note though that the precise wording may change in future versions. The codes in the left column will not change and may be used to show your own custom messages (e.g. translations).</p>
<p>Operations that do not return status or error codes and messages (which is all succesful retrieval operations) will always set the HTTP status to &#x201c;200 OK&#x201d;.</p>

<table border="0" class="table table-striped">
	
<tr class="a">
		
<th style="text-align:left;">HTTP status </th>
		
<th style="text-align:left;">Error code     </th>
		
<th style="text-align:left;">Error message</th>
	</tr>
	
<tr class="b">
		
<td>200 OK </td>
		
<td>(no code) </td>
		
<td>(no message, just search results)</td>
	</tr>
	
<tr class="a">
		
<td>200 OK </td>
		
<td>SUCCESS </td>
		
<td>Index deleted succesfully.</td>
	</tr>
	
<tr class="b">
		
<td>201 Created </td>
		
<td>SUCCESS </td>
		
<td>Index created succesfully.</td>
	</tr>
	
<tr class="a">
		
<td>202 Accepted </td>
		
<td>SUCCESS </td>
		
<td>Documents uploaded succesfully; indexing started.</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>UNKNOWN_OPERATION </td>
		
<td>Unknown operation. Check your URL.</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>NO_DOC_ID </td>
		
<td>Specify document pid.</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>NO_FILTER_GIVEN </td>
		
<td>Document filter required. Please specify 'filter' parameter.</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>FILTER_SYNTAX_ERROR </td>
		
<td>Error parsing FILTERLANG filter query: ERRORMESSAGE</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>UNKNOWN_FILTER_LANG </td>
		
<td>Unknown filter language ' FILTERLANG '. Supported: SUPPORTED_LANGS.</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>NO_PATTERN_GIVEN </td>
		
<td>Text search pattern required. Please specify 'patt' parameter.</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>PATT_SYNTAX_ERROR </td>
		
<td>Syntax error in PATTLANG pattern: ERRORMESSAGE</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>UNKNOWN_PATT_LANG </td>
		
<td>Unknown pattern language 'PATTLANG'. Supported: SUPPORTED_LANGS.</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>UNKNOWN_GROUP_PROPERTY </td>
		
<td>Unknown group property 'NAME'.</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>UNKNOWN_SORT_PROPERTY </td>
		
<td>Unknown sort property 'NAME'.</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>ERROR_IN_GROUP_VALUE </td>
		
<td>Parameter 'viewgroup' has an illegal value: GROUPID</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>GROUP_NOT_FOUND </td>
		
<td>Group not found: GROUPID</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>REGEXP_TOO_LARGE</td>
		
<td>Regular expression too large. (NOTE: maximum size depends on Java stack size)</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>JSONP_ILLEGAL_CALLBACK </td>
		
<td>Illegal JSONP callback function name. Must be a valid Javascript name.</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>SNIPPET_TOO_LARGE </td>
		
<td>Snippet too large. Maximum size for a snippet is MAXSIZE words.</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>ILLEGAL_BOUNDARIES </td>
		
<td>Illegal word boundaries specified. Please check parameters.</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>HIT_NUMBER_OUT_OF_RANGE </td>
		
<td>Non-existent hit number specified.</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>CANNOT_CREATE_INDEX </td>
		
<td>Could not create index. REASON</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>INDEX_ALREADY_EXISTS </td>
		
<td>Could not create index. Index already exists.</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>ILLEGAL_INDEX_NAME </td>
		
<td>Illegal index name (only word characters, underscore and dash allowed): INDEXNAME</td>
	</tr>
	
<tr class="b">
		
<td>400 Bad Request </td>
		
<td>CANNOT_UPLOAD_FILE </td>
		
<td>Cannot upload file. REASON</td>
	</tr>
	
<tr class="a">
		
<td>400 Bad Request </td>
		
<td>INDEX_ERROR </td>
		
<td>An error occurred during indexing: MESSAGE</td>
	</tr>
	
<tr class="b">
		
<td>401 Unauthorized </td>
		
<td>NOT_AUTHORIZED </td>
		
<td>Unauthorized operation. REASON</td>
	</tr>
	
<tr class="a">
		
<td>403 Forbidden </td>
		
<td>FORBIDDEN_REQUEST </td>
		
<td>Forbidden request. REASON</td>
	</tr>
	
<tr class="b">
		
<td>405 Method Not Allowed </td>
		
<td>ILLEGAL_REQUEST </td>
		
<td>Illegal GET/POST/PUT/DELETE request. REASON</td>
	</tr>
	
<tr class="a">
		
<td>404 Not Found </td>
		
<td>CANNOT_OPEN_INDEX </td>
		
<td>Could not open index 'NAME'. Please check the name.</td>
	</tr>
	
<tr class="b">
		
<td>404 Not Found </td>
		
<td>DOC_NOT_FOUND </td>
		
<td>Document with pid 'PID' not found.</td>
	</tr>
	
<tr class="a">
		
<td>409 Conflict </td>
		
<td>INDEX_UNAVAILABLE </td>
		
<td>The index 'INDEXNAME' is not available right now. Status: STATUS</td>
	</tr>
	
<tr class="b">
		
<td>429 Too Many Requests </td>
		
<td>TOO_MANY_JOBS </td>
		
<td>You already have too many running searches. Please wait for some previous searches to complete before starting new ones.</td>
	</tr>
	
<tr class="a">
		
<td>500 Internal Server Error </td>
		
<td>INTERNAL_ERROR </td>
		
<td>An internal error occurred. Please contact the administrator.</td>
	</tr>
	
<tr class="b">
		
<td>503 Service Unavailable </td>
		
<td>SERVER_BUSY </td>
		
<td>The server is under heavy load right now. Please try again later.</td>
	</tr>
	
<tr class="a">
		
<td>503 Service Unavailable </td>
		
<td>SEARCH_TIMED_OUT </td>
		
<td>Search took too long, cancelled.</td>
	</tr>
</table></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2016
                        <a href="http://www.inl.nl">Instituut voor Nederlandse Taal (INT)</a>.
            All rights reserved.      
                    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
